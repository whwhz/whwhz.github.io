<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <!-- cungudafa百度收录验证编号 -->
  <!-- <meta name="baidu-site-verification" content="LukfTcyXmC" /> -->
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/c8f13bc8.js","daovoice")</script>
  
  <title itemprop="name">那些好用的工具函数整理 | Whwhz</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/style.css" type="text/css" media="all" id="saukra_css-css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/jquery.fancybox.min.css" media="all">  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/lib.min.css" media="all">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/tags.css" media="all">
  
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/logo.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/fonts/LOGO/logo.css">
  
  <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>

  <!-- 分析 -->
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <!-- Baidu Analytics -->

  
  <!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
  " type="text/css" media="all"> -->
  <script>
    /*Initial Variables*/
    var mashiro_option = new Object();
    var mashiro_global = new Object();
    mashiro_option.NProgressON = true;
    /* 
    * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
    * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
    */
    mashiro_option.email_domain = "";
    mashiro_option.email_name = "";
    mashiro_option.cookie_version_control = "";
    mashiro_option.qzone_autocomplete = false;
    mashiro_option.site_name = "whwhz光影教会";
    mashiro_option.author_name = "光影教会";
    mashiro_option.site_url = "";
    mashiro_option.v_appId = "U5VwYYeYlmI7C8UuoWxHrDBz-MdYXbMMI";//
    mashiro_option.v_appKey = "SFxC9o4DBWIBfhIBOTHlaXGf";//
    mashiro_option.mathjax = "1";
    mashiro_option.copyright_enable = "false" ;
    mashiro_option.copyright_minCharNumber = parseInt("120") ;
    mashiro_option.copyright_description = "本文章著作权归作者所有，任何形式的转载都请注明出处。" ;
    mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
    mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

    // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
    // mashiro_option.float_player_on = true;

    /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
    var bg = "https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/linglong1.jpg,https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/linglong2.jpg,https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/linglong3.jpg,https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/linglong4.jpg,https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/linglong5.jpg,https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/linglonglogo.png".split(",");
    var bgindex = Math.floor(Math.random()*bg.length);
    if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
      alert('朋友，IE浏览器未适配哦~');
    }
  </script>
<meta name="generator" content="Hexo 5.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head> 

<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <!-- Dynamic sliders -->
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <!-- Main content -->
  <section id="main-container">
    <!-- Top menu -->
    <div class="headertop filter-dot">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="">
          <img src="https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/WechatIMG32.png">
        </a>
      </div>
      <div class="poem-wrap">
        <div class="poem-border poem-left">
        </div>
        <div class="poem-border poem-right">
        </div>
        <p id="poem2" style="color:#fff">loading...</p>
        <p id="info2" style="color:#fff">loading...</p>
      </div>
      <div class="header-info">
        <p>光孕众生，众生随影。光涤吾魂，影庇吾体。</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>

  <!-- <div id="video-container">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div> -->
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
<script>
  $.get("https://v1.hitokoto.cn?c=h&c=a", function (data, status) {
    if (status == 'success') {
      $('#poem2').html(data.hitokoto)
      if (data.from_who != null) {
        $('#info2').html(data.from_who + " · " + "《" + data.from + "》 ");
      } else {
        $('#info2').html(" “ " + data.from + "” ");
      }
    } else {
      $('#poem2').html("获取出错啦");
    }
  });
</script>
    <div id="page" class="site wrapper">
      <!-- banner -->
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
        <span class="site-title">
            <span class="logolink logo">
                <a href="/">
                    <ruby>
                    <span class="sakuraso">光</span>
                    <span class="no">の</span>
                    <span class="shironeko">影</span>
                    <rp></rp>
                    <rt class="logo">whwhz</rt>
                    <rp></rp>
                    </ruby>
                  </a>
            </span>
          </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      
      <!-- body -->
      <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

<div class="pattern-center single-center">
  <!-- 有配图默认渲染第一张 -->
  <div class="pattern-attachment-img lazyload" style="background-image: url(https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/WechatIMG38.jpeg);"
    src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/WechatIMG38.jpeg">
  </div>
  <header class="pattern-header single-header">
    <h1 class="entry-title">那些好用的工具函数整理</h1>
    <p class="entry-census">
      
      
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="fa fa-calendar"></i>
        </span>
        <span class="post-meta-item-text"> 2021-1-8 </span>
      </span>
      <span class="bull">
        ·</span>
      <!-- 浏览数显示 -->
      <span class="post-meta-item" >
        <span class="post-meta-item-icon">
          <i class="iconfont icon-attention"></i>
        </span>
        <span class="post-meta-item-text">本文共<span id="busuanzi_value_page_pv"> </span>次阅读
        </span>
      </span>
      <span class="bull">
        ·</span>
      <!-- 字数统计-->
      <span class="post-meta-item" >

        
      </span>
      <span class="bull">
        ·</span>
      <!-- 评论数显示 -->
      <!-- <span class="post-meta-item" >
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              </span class="post-meta-item-text">
                <span class="valine-comment-count" data-xid="/20333"> </span>
              </span>
          </span> -->
    </p>
  </header>
</div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1"
        class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content">  -->
        <!--套嵌目录使用（主要为了支援评论）-->
        
        <div class="entry-content">
          <h2 id="总结自己一些日常使用的过的工具函数-目前分为数据处理类-时间处理类-对象类-验证函数类和浏览器功能类等-持续更新"><a href="#总结自己一些日常使用的过的工具函数-目前分为数据处理类-时间处理类-对象类-验证函数类和浏览器功能类等-持续更新" class="headerlink" title="总结自己一些日常使用的过的工具函数, 目前分为数据处理类, 时间处理类, 对象类, 验证函数类和浏览器功能类等, 持续更新"></a>总结自己一些日常使用的过的工具函数, 目前分为数据处理类, 时间处理类, 对象类, 验证函数类和浏览器功能类等, 持续更新</h2><h3 id="对象类"><a href="#对象类" class="headerlink" title="对象类"></a>对象类</h3><pre class=" language-格式化JSON内容"><code class="language-格式化JSON内容">/**
 * @param {Object}
 * @returns {JSON}
 */
const stringify = (() => {
  const replacer = (key, val) => {
    if(typeof val === 'symbol') {
      return val.toString();
    }
    if(val instanceof Set) {
      return Array.from(val);
    }
    if(val instanceof Map) {
      return Array.from(val.entries());
    }
    if(typeof val === 'function') {
      return val.toString();
    }
    return val;
  }

  return (obj, spaces = 0) => JSON.stringify(obj, replacer, spaces)
})();</code></pre>
<pre class=" language-空值检测"><code class="language-空值检测">/**
 * @param {Object|Array} 用于检测对象或数组是否为空
 * @returns {Boolean}
 */
export function isEmpty(x) {
  if(Array.isArray(x)
    || typeof x === 'string'
    || x instanceof String
   ) {
    return x.length === 0;
  }

  if(x instanceof Map || x instanceof Set) {
    return x.size === 0;
  }

  if(({}).toString.call(x) === '[object Object]') {
    return Object.keys(x).length === 0;
  }

  return false;
}</code></pre>
<pre class=" language-深度克隆"><code class="language-深度克隆">/**
 * @param {Object} 一般JSON.parse(JSON.stringify(obj))不能满足就用得到
 * @returns {Object}
 */
export function deepClone(source) {
  if (!source && typeof source !== 'object') {
    throw new Error('error arguments', 'deepClone')
  }
  const targetObj = source.constructor === Array ? [] : {}
  Object.keys(source).forEach(keys => {
    if (source[keys] && typeof source[keys] === 'object') {
      targetObj[keys] = deepClone(source[keys])
    } else {
      targetObj[keys] = source[keys]
    }
  })
  return targetObj
}</code></pre>
<pre class=" language-对象合并"><code class="language-对象合并">/**
 * @param {Object} target
 * @param {(Object|Array)} 第二个参数可以是包含多个对象的数组
 * @returns {Object}
 */
export function objectMerge(target, source) {
  if (typeof target !== 'object') {
    target = {}
  }
  if (Array.isArray(source)) {
    return source.slice()
  }
  Object.keys(source).forEach(property => {
    const sourceProperty = source[property]
    if (typeof sourceProperty === 'object') {
      target[property] = objectMerge(target[property], sourceProperty)
    } else {
      target[property] = sourceProperty
    }
  })
  return target
}</code></pre>
<h3 id="时间类"><a href="#时间类" class="headerlink" title="时间类"></a>时间类</h3><pre class=" language-时间转义字符串"><code class="language-时间转义字符串">/**
 * Parse the time to string
 * @param {(Object|string|number)} time
 * @param {string} cFormat
 * @returns {string | null}
 */
export function parseTime(time, cFormat) {
  if (arguments.length === 0) {
    return null
  }
  const format = cFormat || '{y}-{m}-{d} {h}:{i}:{s}'
  let date
  if (typeof time === 'object') {
    date = time
  } else {
    if ((typeof time === 'string') && (/^[0-9]+$/.test(time))) {
      time = parseInt(time)
    }
    if ((typeof time === 'number') && (time.toString().length === 10)) {
      time = time * 1000
    }
    date = new Date(time)
  }
  const formatObj = {
    y: date.getFullYear(),
    m: date.getMonth() + 1,
    d: date.getDate(),
    h: date.getHours(),
    i: date.getMinutes(),
    s: date.getSeconds(),
    a: date.getDay()
  }
  const time_str = format.replace(/{([ymdhisa])+}/g, (result, key) => {
    const value = formatObj[key]
    // Note: getDay() returns 0 on Sunday
    if (key === 'a') { return ['日', '一', '二', '三', '四', '五', '六'][value ] }
    return value.toString().padStart(2, '0')
  })
  return time_str
}</code></pre>
<pre class=" language-评论时间转换"><code class="language-评论时间转换">/**
 * @param {number} time
 * @param {string} option 需要结合上面的函数一起使用
 * @returns {string}
 */
export function formatTime(time, option) {
  if (('' + time).length === 10) {
    time = parseInt(time) * 1000
  } else {
    time = +time
  }
  const d = new Date(time)
  const now = Date.now()

  const diff = (now - d) / 1000

  if (diff < 30) {
    return '刚刚'
  } else if (diff < 3600) {
    // less 1 hour
    return Math.ceil(diff / 60) + '分钟前'
  } else if (diff < 3600 * 24) {
    return Math.ceil(diff / 3600) + '小时前'
  } else if (diff < 3600 * 24 * 2) {
    return '1天前'
  }
  if (option) {
    return parseTime(time, option)
  } else {
    return (
      d.getMonth() +
      1 +
      '月' +
      d.getDate() +
      '日' +
      d.getHours() +
      '时' +
      d.getMinutes() +
      '分'
    )
  }
}</code></pre>
<h3 id="数据类"><a href="#数据类" class="headerlink" title="数据类"></a>数据类</h3><pre class=" language-数据的循环"><code class="language-数据的循环">/**
 * @param {Array|Object} list
 * @param {func} cb 回调函数
 */
export function forEach(list, callback) {
  const entries = Object.entries(list);
  let i = 0;
  const len = entries.length;

  for(;i < len; i++) {
    const res = callback(entries[i][1], entries[i][0], list);

    if(res === true) break;
  }
}</code></pre>
<pre class=" language-类型检测"><code class="language-类型检测">export const isOfType = (() => {
  // create a plain object with no prototype
  const type = Object.create(null);

  // check for null type
  type.null = x => x === null;
  // check for undefined type
  type.undefined = x => x === undefined;
  // check for nil type. Either null or undefined
  type.nil = x => type.null(x) || type.undefined(x);
  // check for strings and string literal type. e.g: 's', "s", `str`, new String()
  type.string = x => !type.nil(x) && (typeof x === 'string' || x instanceof String);
  // check for number or number literal type. e.g: 12, 30.5, new Number()
  type.number = x => !type.nil(x)
    && (// NaN & Infinity have typeof "number" and this excludes that
      (!isNaN(x) && isFinite(x)
      && typeof x === 'number'
    ) || x instanceof Number);
  // check for boolean or boolean literal type. e.g: true, false, new Boolean()
  type.boolean = x => !type.nil(x) && (typeof x === 'boolean' || x instanceof Boolean);
  // check for array type
  type.array = x => !type.nil(x) && Array.isArray(x);
  // check for object or object literal type. e.g: {}, new Object(), Object.create(null)
  type.object = x => ({}).toString.call(x) === '[object Object]';
  // check for provided type instance
  type.type = (x, X) => !type.nil(x) && x instanceof X;
  // check for set type
  type.set = x => type.type(x, Set);
  // check for map type
  type.map = x => type.type(x, Map);
  // check for date type
  type.date = x => type.type(x, Date);

  return type;
})();</code></pre>
<pre class=" language-随机字符串"><code class="language-随机字符串">/**
 * @returns {string}
 */
export function createUniqueString() {
  const timestamp = +new Date() + ''
  const randomNum = parseInt((1 + Math.random()) * 65536) + ''
  return (+(randomNum + timestamp)).toString(32)
}</code></pre>
<pre class=" language-查询参数截取"><code class="language-查询参数截取">/**
 * @param {string} url
 * @returns {Object}
 */
export function getQueryObject(url) {
  url = url == null ? window.location.href : url
  const search = url.substring(url.lastIndexOf('?') + 1)
  const obj = {}
  const reg = /([^?&=]+)=([^?&=]*)/g
  search.replace(reg, (rs, $1, $2) => {
    const name = decodeURIComponent($1)
    let val = decodeURIComponent($2)
    val = String(val)
    obj[name] = val
    return rs
  })
  return obj
}</code></pre>
<h3 id="验证类"><a href="#验证类" class="headerlink" title="验证类"></a>验证类</h3><pre class=" language-身份证验证"><code class="language-身份证验证">/*
 * @param {String} 身份证号
 * @returns {Boolean}
 */
export const certNoValidate = certNo => {
  if (certNo) {
    // 加权因子
    const weight_factor = [7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2];
    // 校验码
    const check_code = ["1", "0", "X", "9", "8", "7", "6", "5", "4", "3", "2"];
    let code = certNo + "";
    let last = certNo[17]; //最后一个
    let seventeen = code.substring(0, 17);
    let arr = seventeen.split("");
    let len = arr.length;
    let num = 0;
    for (let i = 0; i < len; i++) {
      num = num + arr[i] * weight_factor[i];
    }
    let resisue = num % 11;
    let last_no = check_code[resisue];
    const newReg = /^[1-9][0-9]{5}([1][9][0-9]{2}|[2][0][0|1][0-9])([0][1-9]|[1][0|1|2])([0][1-9]|[1|2][0-9]|[3][0|1])[0-9]{3}([0-9]|[X])$/;
    let format = newReg.test(certNo);
    if (last_no && format) {
      return true;
    } else {
      return false;
    }
  } else {
    return false;
  }
};
</code></pre>
<pre class=" language-手机号码验证"><code class="language-手机号码验证">/*
 * @param {String} 只适合国内手机, 海外目前没接触
 * @returns {Boolean}
 */
export const mobileValidate = mobile => {
  const newReg = /^1(3|4|5|6|7|8|9)\d{9}$/;
  if (newReg.test(mobile)) {
    return true;
  } else {
    return false;
  }
};
</code></pre>
<pre class=" language-密码验证"><code class="language-密码验证">/*
 * @param {String} 至少6位的字母数字组合
 * @returns {Boolean}
 */
export const pwdValidate = pwd => {
  const reg = /(?=.*?[a-zA-Z])(?=.*?[0-9])[a-zA-Z0-9]{6,}$/;
  if (reg.test(pwd)) {
    return true;
  } else {
    return false;
  }
};
</code></pre>
<h3 id="浏览器类"><a href="#浏览器类" class="headerlink" title="浏览器类"></a>浏览器类</h3><pre class=" language-地址文件下载封装"><code class="language-地址文件下载封装">/* 相较于a标签直接下载可以附加参数, 可以用于权限控制中的请求下载
 * @param {String} 文件url
 * @param {Object} 请求参数
 * @returns Null
 */
export function downloadFile(downLoadurl, params = {}, method = "get") {
  // params = { ...params, token: store.getters.token };
  const downloadForm = document.createElement("form");
  try {
    if (downloadForm) {
      // downloadForm.action = 'http://192.168.1.108:9001' + downLoadurl
      downloadForm.action = downLoadurl;
      downloadForm.method = method;
      for (const key in params) {
        if (!params[key]) continue;
        const input = document.createElement("input");
        input.type = "hidden";
        input.name = key;
        input.value = params[key];
        downloadForm.appendChild(input);
      }
      // downloadForm.headers = {
      //   token: store.getters.token
      // };
      document.body.appendChild(downloadForm);
      downloadForm.submit();
    }
  } catch (e) {
    console.log(e);
  } finally {
    document.body.removeChild(downloadForm);
  }
}</code></pre>
<pre class=" language-添加/删除class"><code class="language-添加/删除class">/**
 * Add class to element
 * @param {HTMLElement} elm
 * @param {string} cls
 */
export function addClass(ele, cls) {
  if (!hasClass(ele, cls)) ele.className += ' ' + cls
}

/**
 * Remove class from element
 * @param {HTMLElement} elm
 * @param {string} cls
 */
export function removeClass(ele, cls) {
  if (hasClass(ele, cls)) {
    const reg = new RegExp('(\\s|^)' + cls + '(\\s|$)')
    ele.className = ele.className.replace(reg, ' ')
  }
}</code></pre>
<pre class=" language-检测是否存在class"><code class="language-检测是否存在class">/**
 * @param {HTMLElement} elm
 * @param {string} cls
 * @returns {boolean}
 */
export function hasClass(ele, cls) {
  return !!ele.className.match(new RegExp('(\\s|^)' + cls + '(\\s|$)'))
}</code></pre>
<pre class=" language-修改元素class"><code class="language-修改元素class">/**
 * @param {HTMLElement} element
 * @param {string} className
 */
export function toggleClass(element, className) {
  if (!element || !className) {
    return
  }
  let classString = element.className
  const nameIndex = classString.indexOf(className)
  if (nameIndex === -1) {
    classString += '' + className
  } else {
    classString =
      classString.substr(0, nameIndex) +
      classString.substr(nameIndex + className.length)
  }
  element.className = classString
}</code></pre>
<pre class=" language-文件格式转换"><code class="language-文件格式转换">/* base64转file
 * @param {file}
 * @returns {base64}
 */
 function dataURLtoFile(base64) {
  let arr = base64.split(","),
    mime = arr[0].match(/:(.*?);/)[1],
    bstr = atob(arr[1]),
    n = bstr.length,
    u8arr = new Uint8Array(n);
  while (n--) {
    u8arr[n] = bstr.charCodeAt(n);
  }
  return new File([u8arr], { type: mime });
}
/* base64转二进制
 * @param {String} “data:image/png;base64,****”,逗号之前都是一些说明性的文字，我们只需要逗号之后的就行了
 * @returns {blob}
 */
function dataToBlob(data, mime) {
  data = data.split(',')[1]
  data = window.atob(data)
  var ia = new Uint8Array(data.length)
  for (var i = 0; i < data.length; i++) {
    ia[i] = data.charCodeAt(i)
  }
  // canvas.toDataURL 返回的默认格式就是 image/png
  return new Blob([ia], {
    type: mime
  })
}
</code></pre>
<pre class=" language-图片压缩"><code class="language-图片压缩">/* 压缩图片
 * @param {file}
 * @returns {base64}
 */
export function compressImg(file) {
  let src;
  let fileSize = parseFloat(parseInt(file["size"]) / 1024 / 1024).toFixed(2);
  let read = new FileReader();
  read.readAsDataURL(file);
  return new Promise(function(resolve, reject) {
    read.onload = function(e) {
      let img = new Image();
      img.src = e.target.result;
      img.onload = function() {
        //默认按比例压缩
        let w = this.width,
          h = this.height; //生成canvas
        let canvas = document.createElement("canvas");
        let ctx = canvas.getContext("2d");
        let base64; // 创建属性节点
        canvas.setAttribute("width", w);
        canvas.setAttribute("height", h);
        ctx.drawImage(this, 0, 0, w, h);
        if (fileSize < 1) {
          //如果图片小于一兆 那么不执行压缩操作
          base64 = canvas.toDataURL(file["type"], 1);
        } else if (fileSize > 1 && fileSize < 2) {
          //如果图片大于1M并且小于2M 那么压缩0.5
          base64 = canvas.toDataURL(file["type"], 0.5);
        } else {
          //如果图片超过2m 那么压缩0.2
          base64 = canvas.toDataURL(file["type"], 0.2);
        }
        // 这里返回的是base64编码 如果想要文件格式还需要再次转换
        resolve(base64);
      };
    };
  });
}
</code></pre>
<div id="weather-v2-plugin-simple"></div>
<script>
WIDGET = {
  CONFIG: {
    "modules": "0124",
    "background": 1,
    "tmpColor": "FFFFFF",
    "tmpSize": 16,
    "cityColor": "FFFFFF",
    "citySize": 16,
    "aqiSize": 16,
    "weatherIconSize": 24,
    "alertIconSize": 18,
    "padding": "10px 10px 10px 10px",
    "shadow": "1",
    "language": "auto",
    "borderRadius": 5,
    "fixed": "false",
    "vertical": "middle",
    "horizontal": "center",
    "key": "B1Dc3JIvYg"
  }
}
</script>
<script src="https://apip.weatherdt.com/simple/static/js/weather-simple-common.js?v=2.0"></script>

        </div>

        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/alipay.jpeg"></li>
                <li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/wechat.jpeg"></li>
              </ul>
            </div>
          </div>
        </div>
        <!-- <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent">
        </div> -->
        <!-- 评分 -->
        <div class="single-reward">
          
          <!-- 五星评分 -->
<!-- <div id="wpac-rating"></div> -->
<!-- <script type="text/javascript">
wpac_init = window.wpac_init || [];
wpac_init.push({widget: 'Rating', id: 23889});
(function() {
    if ('WIDGETPACK_LOADED' in window) return;
    WIDGETPACK_LOADED = true;
    var mc = document.createElement('script');
    mc.type = 'text/javascript';
    mc.async = true;
    mc.src = 'https://embed.widgetpack.com/widget.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
})();
</script> -->
<!-- <a target="_blank" rel="noopener" href="https://widgetpack.com" class="wpac-cr">Star Rating WIDGET PACK</a> -->
          
        </div>
        <!-- 自定义署名方式 -->
        <!-- <footer class="post-footer"> -->
          <!-- <div class="post-lincenses" style="color: #ff9966;">
            欢迎转载，转载时请注明来源哦！
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" style="color: #ff9966;" target="_blank"
              rel="nofollow">
              <i class="fa fa-creative-commons" aria-hidden="true"></i>ncsa4.0</a>
          </div> -->
          <!-- 
          <div class="post-tags" style="color: #a39391">
            <span><i class="fa fa-tags"></i>
              
              <a href="/tags/JavaScript/" style="color: #716e77;">JavaScript<em>·</em></a>
              
            </span>
            <span>
              <i class="iconfont icon-file"></i>
              
            </span>
          </div>
          
          <div class="post-share" >
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div> -->
        <!-- </footer> -->
        <!-- .entry-footer -->
        <!-- <div class="tag-cloud">
          <div class="tag-cloud-title">
          </div>
          <div class="tag-cloud-tags">
            <a href="/tags/JavaScript/" style="font-size: 20px; color: #39bae8">JavaScript</a> <a href="/tags/vue/" style="font-size: 10px; color: #f06966">vue</a>
          </div>
        </div> -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
        
        <div class="post-nepre half previous">
          
            <a href="/post/61197.html" rel="prev">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/nuxtjs.png"
                  style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)"
                  src="https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/nuxtjs.png">
              </div>
              <span class="label">Previous Post</span>
              <div class="info">
                <h3>Nuxt框架使用踩坑</h3>
                <hr>
              </div>
            </a>
          </div>
          
          
          
          <div class="post-nepre half next">
            
              <a href="/post/31766.html" rel="next">
                <div class="background">
                  <img class="lazyload" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/loader/orange.progress-bar-stripe-loader.svg" data-src=""
                    style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;"
                    onerror="imgError(this,3)" src="">
                </div>
                <span class="label">Next Post</span>
                <div class="info">
                  <h3>ones</h3>
                  <hr>
                </div>
              </a>
            </div>
            
      </section>
      <!-- 加密文章隐藏评论 -->
      <!-- <section class="comment" >
        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<div id="gitalk-container" class="comment"></div> 
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="/js/md5.min.js"></script>
<script type="text/javascript">
	var gitalk = new Gitalk({
  	clientID: '0ef89257a5aaf8e30d52',
  	clientSecret: '046080d6bfacf6607a3c48c349d945069f28ae72',
  	repo: 'cungudafa.github.io',
  	owner: 'cungudafa',
	admin: ['cungudafa'],
	distractionFreeMode: 'true',
    id: md5(location.pathname)
})
gitalk.render('gitalk-container') 
</script>

      </section> -->
      <!-- 加密文章隐藏作者信息 -->
      <!--  -->
    </main><!-- #main -->
  </div><!-- #primary -->
</div>


<!--评论配置-->



      <!-- body.end -->
    </div>
    <!-- search -->    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- footer-->    
    
    <footer id="colophon" class="site-footer" role="contentinfo">
    <div class="site-info">
        <div class="footertext">
          <div class="img-preload">
              <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
              <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
          </div>
        </div>
        <!-- 网站数据统计 -->
        <div class="footer-device">
          <p style="font-family: 'Ubuntu', sans-serif;">
            <span style="color: #ff9999;padding-left: 20px;">
                <!-- 网站运行时间统计 -->
                <i class="fa fa-clock-o" aria-hidden="true"></i>
                <span id="time" align="center">载入时间中...</span>
                <script>
                var now = new Date(); 
                function createtime() { 
                      var grt= new Date("Thu Jan 07 2021 18:23:00 GMT+0800 (中国标准时间)");//在此处修改你的建站时间
                      now.setTime(now.getTime()+250); 
                      days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
                      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
                      if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
                      mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
                      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
                      snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
                      document.getElementById("time").innerHTML = "小破站在各种灾难中苟活了 "+ dnum +" 天 "+hnum + " 小时 " + mnum + " 分 " + snum + " 秒";      
                  } 
                  setInterval("createtime()",250);
                </script>
            </span> 
          </p>
        </div>

        <!-- 作者注明 -->
        <div class="footer-device">
          <p style="font-family: 'Ubuntu', sans-serif;">
              <span style="color: #b9b9b9;">
                Copyright &copy; 2021
                &nbsp;<a style="color: #ff9999;display:inline-block"> zwh </a>
                &nbsp;<i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> 
                &nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank" style="color: #ff9999;display:inline-block">Hexo/Cungudafa</a>
                |&nbsp;Theme&nbsp;<a href="https://gitee.com/cungudafa/hexo-theme-sakuraplus" target="_blank" style="color: #ff9999;display:inline-block">SakuraPlus</a>
              </span>
          </p>
        </div>
         <!-- 网站作者版权注明 -->
         
    </div><!-- .site-info -->
</footer>


<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/InsightSearch.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/sakura-app.js"></script>


<!-- fancybox大图查看 需jq -->

  <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/jquery.fancybox.min.js"></script>
  <script>
    $('[data-fancybox="images"]').fancybox({
      thumbs : {
        autoStart : true //缩略图
      }
    });
    $('[data-fancybox]').fancybox({
      protect: true,//图片右键不能下载
      youtube : {
          controls : 0,
          showinfo : 0
      },
      vimeo : {
          color : 'f00'
      }
    });
  </script>


<!-- 自适应浏览器 -->
<script type="text/javascript">
  /* <![CDATA[ */
  if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
    var Poi = {"pjax":"0","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
  } else {
    var Poi = {"pjax":"0","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
  }
  /* ]]> */
  
  </script>
  <script>
  $(document).ready(function() {
    if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
      if ($(".pattern-center").length > 0) { //有图的情况
        tocbot.init({
            // Where to render the table of contents.
            tocSelector: '.toc', // 放置目录的容器
            // Where to grab the headings to build the table of contents.
            contentSelector: '.entry-content', // 正文内容所在
            // Which headings to grab inside of the contentSelector element.
            scrollSmooth: true,
            headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
            headingsOffset: -400,
            scrollSmoothOffset: -85
        });
      } else {
        tocbot.init({
            // Where to render the table of contents.
            tocSelector: '.toc', // 放置目录的容器
            // Where to grab the headings to build the table of contents.
            contentSelector: '.entry-content', // 正文内容所在
            // Which headings to grab inside of the contentSelector element.
            scrollSmooth: true,
            headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
            headingsOffset: -85,
            scrollSmoothOffset: -85
        });
      }
      var offsetTop = $('.toc').offset().top - 95;
      window.onscroll = function() {
        var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
        if (scrollTop >= offsetTop) {
          $('.toc').addClass('toc-fixed');
        } else {
          $('.toc').removeClass('toc-fixed');
        }
      }
    }
  });
  </script>
   
    <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/f6b2a0b1.js","daovoice")
      daovoice('init', {
        app_id: ""
      });
      daovoice('update');
    </script>
    
    <!-- Side menu -->
    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <!-- Floating window -->
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/whwhz/jsdelivr/img/WechatIMG32.png">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">whwhz光影教会</p>
  <p style="text-align: center; word-spacing: 20px;">
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2020 hexo-sakuraplus</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  
   <!-- pages壁纸切换 -->
 
    <div class="skin-menu no-select" id="mainskin"  style="position: fixed">
        <div class="theme-controls row-container">
            <ul class="menu-list">
                <li id="white-bg"> <i class="fa fa-television" aria-hidden="true"></i></li>
                <li id="sakura-bg"> <i class="iconfont icon-sakura"></i></li>
                <li id="gribs-bg"> <i class="fa fa-slack" aria-hidden="true"></i></li>
                <li id="KAdots-bg"> <i class="iconfont icon-dots"></i></li>
                <li id="totem-bg"> <i class="fa fa-optin-monster" aria-hidden="true"></i></li>
                <li id="pixiv-bg"> <i class="iconfont icon-pixiv"></i></li>
                <li id="bing-bg"> <i class="iconfont icon-bing"></i></li>
                <li id="dark-bg"> <i class="fa fa-moon-o" aria-hidden="true"></i></li>
            </ul>
        </div>
        <div class="font-family-controls row-container">
            <button type="button" class="control-btn-serif selected" data-mode="serif" onclick="mashiro_global.font_control.change_font()">Serif</button>
            <button type="button" class="control-btn-sans-serif" data-mode="sans-serif" onclick="mashiro_global.font_control.change_font()">Sans Serif</button>
        </div>
    </div>   
    <canvas id="night-mode-cover"></canvas> 
        <div class="changeSkin-gear no-select">
        <div class="keys" id="setbtn"> <span id="open-skinMenu"> 切换壁纸 | SCHEME TOOL 
            &nbsp;<i class="iconfont icon-gear inline-block rotating"></i> </span></div>
    </div><!-- skin.end -->

  <!-- left side bar -->

 <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>